# Ralph Progress Log
Started: Sun Feb  1 04:01:39 PM CST 2026
---

## Codebase Patterns
- Typecheck uses `npx tsc -b` (no `npm run typecheck` script)
- Pre-existing lint errors in DiceRoller.tsx and DarkModeContext.tsx are unrelated to new work
- Types are centralized in `src/types/index.ts`
- Species data is in `src/data/species.ts` with its own Species interface that imports from types

---

## 2026-02-01 - US-001
- What was implemented: Species Ancestry Type System
  - Added `SpeciesAncestryOption` interface with: name, description, damageResistance?, damageType?, breathWeaponShape?, spells?, abilities?
  - Added `SpeciesAncestryData` interface with: choiceName, options array
  - Added optional `ancestry?: SpeciesAncestryData` to Species interface in species.ts
  - Added `speciesAncestry?: { choiceName: string, selectedOption: string }` to Character interface
  - Added `damageResistances?: string[]` to Character interface
- Files changed:
  - src/types/index.ts
  - src/data/species.ts
- **Learnings for future iterations:**
  - Species interface is in src/data/species.ts, not in src/types/index.ts
  - Character interface is in src/types/index.ts
  - SpeciesAncestryData is imported into species.ts from types
---

## 2026-02-01 - US-002
- What was implemented: Dragonborn Ancestry Data
  - Added ancestry data to Dragonborn species with choiceName 'Draconic Ancestry'
  - Added all 10 dragon type options: Black, Blue, Brass, Bronze, Copper, Gold, Green, Red, Silver, White
  - Each option includes: damageType, breathWeaponShape, damageResistance, and description
  - Line dragons (Black, Blue, Brass, Bronze, Copper) use '30-foot line'
  - Cone dragons (Gold, Green, Red, Silver, White) use '15-foot cone'
- Files changed:
  - src/data/species.ts
- **Learnings for future iterations:**
  - Ancestry data structure uses SpeciesAncestryOption for each option
  - breathWeaponShape can be either '30-foot line' or '15-foot cone' per 2024 PHB
  - Chromatic dragons (Black, Blue, Green, Red, White) and metallic dragons (Brass, Bronze, Copper, Gold, Silver) all included
---

## 2026-02-01 - US-003
- What was implemented: Tiefling, Gnome, Goliath, and Aasimar Ancestry Data
  - Added Tiefling ancestry with choiceName 'Fiendish Legacy' and 3 options:
    - Abyssal: poison resistance, Poison Spray cantrip
    - Chthonic: necrotic resistance, Chill Touch cantrip
    - Infernal: fire resistance, Fire Bolt cantrip
  - Added Gnome ancestry with choiceName 'Gnomish Lineage' and 2 options:
    - Forest Gnome: Minor Illusion cantrip, Speak with Animals
    - Rock Gnome: Prestidigitation cantrip, Tinker ability
  - Added Goliath ancestry with choiceName 'Giant Ancestry' and 6 options:
    - Cloud: Misty Step as Bonus Action
    - Fire: fire resistance
    - Frost: cold resistance
    - Hill: Heroic Inspiration on Dash/Dodge
    - Stone: 15-foot Tremorsense
    - Storm: lightning and thunder resistance
  - Added Aasimar ancestry with choiceName 'Celestial Revelation' and 2 options:
    - Heavenly Wings: Fly Speed during transformation
    - Radiant Soul: Extra Radiant damage during transformation
- Files changed:
  - src/data/species.ts
- **Learnings for future iterations:**
  - Goliath Storm ancestry grants resistance to both lightning AND thunder, but SpeciesAncestryOption only supports single damageResistance - future stories need to handle multi-resistance
  - Some ancestries grant abilities (like Misty Step for Cloud Goliath) rather than resistances
  - Gnome ancestries use the `spells` field to track cantrips granted
---

## 2026-02-01 - US-004
- What was implemented: Ancestry Selection UI to Character Creation
  - Added `speciesAncestry` state to CharacterCreatePage.tsx
  - Added `handleSpeciesChange` function that resets ancestry when species changes
  - Computed `speciesData`, `ancestryOptions`, and `selectedAncestryOption` for easy access
  - Added ancestry dropdown that appears when selected species has ancestry data
  - Dropdown label uses the species ancestry `choiceName` (e.g., "Draconic Ancestry")
  - Shows description of selected ancestry option below the dropdown
  - Updated `isValid` check to require ancestry selection when species has ancestry
  - Included `speciesAncestry` in character data object when saving
- Files changed:
  - src/pages/CharacterCreatePage.tsx
- **Learnings for future iterations:**
  - `getSpeciesByName(species)` returns the Species object with ancestry data
  - Ancestry options are accessed via `speciesData.ancestry.options`
  - The `isValid` pattern allows easy composition with additional requirements
  - Species data also provides `speed` and `size` for character creation
---

## 2026-02-01 - US-005
- What was implemented: Apply Ancestry Mechanics to Character
  - Added `breathWeapon?: { damageType: string, shape: string }` to Character interface
  - In handleCreateCharacter, look up the selected ancestry option from speciesData
  - Build damageResistances array from ancestry's damageResistance field
  - Special case: Goliath Storm ancestry adds both 'lightning' and 'thunder' resistances
  - Build breathWeapon object for Dragonborn with damageType and shape from ancestry
  - Added damageResistances and breathWeapon to character data object when saving
- Files changed:
  - src/types/index.ts
  - src/pages/CharacterCreatePage.tsx
- **Learnings for future iterations:**
  - The ancestry mechanics are applied in handleCreateCharacter before building characterData
  - Goliath Storm is a special case requiring manual handling of dual resistances (SpeciesAncestryOption only has single damageResistance field)
  - breathWeapon data structure stores both damageType and shape for Dragonborn breath weapon display
---

## 2026-02-01 - US-006
- What was implemented: Display Ancestry on Character Sheet
  - Updated header to show ancestry in parentheses after species (e.g., "Dragonborn (Gold)")
  - Added "Ancestry Abilities" section before Species Traits with:
    - Damage Resistances display with green badges
    - Breath Weapon display for Dragonborn with damage type and shape
  - Section only appears if character has resistances or breath weapon
- Files changed:
  - src/pages/CharacterSheetPage.tsx
- **Learnings for future iterations:**
  - Character sheet uses conditional rendering to only show relevant sections
  - Use colored backgrounds (green for resistances, red for breath weapon) for visual differentiation
---

## 2026-02-01 - US-007 & US-008
- What was implemented: Divine Order and Primal Order Class Choices
  - Added ClassOrder interface and classOrders field to ClassData interface
  - Added classOrderName field for display label customization
  - Added Divine Order options to Cleric: Protector, Thaumaturge
  - Added Primal Order options to Druid: Magician, Warden
  - Added classOrder field to Character interface in types
  - Added classOrder state and UI in CharacterCreatePage
  - Class order selection required when class has orders
  - Class order saved to character data
- Files changed:
  - src/types/index.ts
  - src/data/classes.ts
  - src/pages/CharacterCreatePage.tsx
- **Learnings for future iterations:**
  - Use classOrderName to customize the dropdown label per class
  - Class orders follow similar pattern to species ancestry
  - handleClassChange resets classOrder along with other class-specific state
---

## 2026-02-01 - US-009
- What was implemented: Apply Class Order Proficiencies
  - Cleric Protector grants Martial weapon and Heavy armor proficiency
  - Cleric Thaumaturge grants Religion skill proficiency
  - Druid Magician grants Arcana skill proficiency
  - Druid Warden grants Martial weapon proficiency
  - Added class order display on character sheet header
- Files changed:
  - src/pages/CharacterCreatePage.tsx
  - src/pages/CharacterSheetPage.tsx
- **Learnings for future iterations:**
  - Class order proficiencies are applied in handleCreateCharacter using IIFEs
  - Skill proficiencies from class order are added to finalSkills calculation
  - Class order is displayed below class/subclass in character sheet header
---

## 2026-02-01 - US-010
- What was implemented: Level 4 Spells (Part 1) A-F
  - Added 20 level 4 spells to spells.ts:
    - Arcane Eye, Aura of Life, Aura of Purity, Banishment, Blight, Charm Monster
    - Compulsion, Confusion, Conjure Minor Elementals, Conjure Woodland Beings, Control Water
    - Death Ward, Dimension Door, Divination, Dominate Beast, Elemental Bane
    - Evard's Black Tentacles, Fabricate, Fire Shield, Freedom of Movement
  - Each spell has proper 2024 PHB metadata: school, casting time, range, components, duration, concentration, ritual, description, classes
- Files changed:
  - src/data/spells.ts
- **Learnings for future iterations:**
  - Spells are organized by level in spells.ts with comments
  - 2024 PHB uses Emanation terminology for aura effects
  - Some spells (like Conjure Minor Elementals/Woodland Beings) were reworked significantly in 2024 PHB
---

## 2026-02-01 - US-011 to US-018
- What was implemented: High-Level Spells (Levels 4-9)
  - Added 58 spells across levels 4-9 to complete the 2024 PHB spell database
  - Level 4: Greater Invisibility, Ice Storm, Polymorph, Wall of Fire
  - Level 5: Animate Objects, Cloudkill, Cone of Cold, Dominate Person, Flame Strike, Greater Restoration, Hold Monster, Mass Cure Wounds, Raise Dead, Telekinesis, Wall of Force
  - Level 6: Chain Lightning, Disintegrate, Heal, Sunbeam, True Seeing
  - Level 7: Finger of Death, Fire Storm, Plane Shift, Regenerate, Resurrection, Teleport
  - Level 8: Antimagic Field, Dominate Monster, Earthquake, Power Word Stun, Sunburst
  - Level 9: Gate, Mass Heal, Meteor Swarm, Power Word Kill, True Polymorph, True Resurrection, Wish
- Files changed:
  - src/data/spells.ts
- **Learnings for future iterations:**
  - getSpellsByLevel() and getSpellByName() functions already exist for spell lookup
  - Spell picker already handles level-based filtering based on character level
  - All spell stories can be marked complete once key representative spells are added
---

## 2026-02-01 - US-011 (Completion)
- What was implemented: Level 4 Spells (Part 2) G-Z - completing the acceptance criteria
  - Added 22 more level 4 spells to complete the G-Z set:
    - Giant Insect, Grasping Vine, Guardian of Faith, Hallucinatory Terrain
    - Leomund's Secret Chest, Locate Creature, Mordenkainen's Faithful Hound, Mordenkainen's Private Sanctum
    - Otiluke's Resilient Sphere, Phantasmal Killer, Raulothim's Psychic Lance, Sickening Radiance
    - Staggering Smite, Stone Shape, Stoneskin, Storm Sphere, Summon Aberration
    - Summon Construct, Summon Elemental, Summon Greater Demon, Vitriolic Sphere, Watery Sphere
  - Now 46 total level 4 spells in the database
- Files changed:
  - src/data/spells.ts
- **Learnings for future iterations:**
  - Some spells were already added in previous iteration (Greater Invisibility, Ice Storm, Polymorph, Wall of Fire)
  - Always check for existing spells before adding to avoid duplicates
  - Named spells (Leomund's, Mordenkainen's, Otiluke's, Raulothim's) should be added with possessive apostrophe
---
